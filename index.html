<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TADY - Everywhere is Here</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --gold: #ffd700; --cyan: #00f2ff; --p: #764ba2; --bg: #0b1118; --glass: rgba(255, 255, 255, 0.1); }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: 'Inter', sans-serif; background: var(--bg); color: #fff; overflow: hidden; }
        
        /* AR Engine Viewport */
        #ar-viewport { position: fixed; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1; display: none; }
        #ar-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; pointer-events: none; }

        header { 
            position: relative; z-index: 10; background: linear-gradient(180deg, rgba(11,17,24,0.9) 0%, rgba(11,17,24,0) 100%); 
            padding: 30px 20px; text-align: center;
        }
        .logo { font-size: 2.5rem; font-weight: 900; letter-spacing: 10px; text-shadow: 0 0 20px var(--cyan); }
        .slogan { font-size: 0.7rem; letter-spacing: 3px; color: var(--cyan); text-transform: uppercase; margin-top: 5px; }

        /* UI Elements */
        .container { position: relative; z-index: 10; padding: 20px; max-width: 600px; margin: 0 auto; transition: 0.5s; }
        #map { height: 400px; border-radius: 30px; border: 1px solid var(--glass); box-shadow: 0 20px 50px rgba(0,0,0,0.8); margin: 20px 0; }
        
        /* Floating AR Bubbles */
        .bubble { 
            position: absolute; background: var(--glass); backdrop-filter: blur(15px); border-radius: 25px; 
            padding: 20px; border: 1px solid rgba(255,255,255,0.2); animation: float 4s ease-in-out infinite;
            min-width: 150px; text-align: center; pointer-events: auto;
        }
        .bubble.gold { border: 2px solid var(--gold); box-shadow: 0 0 30px rgba(255,215,0,0.4); color: var(--gold); }

        .creator-tag { position: fixed; top: 20px; right: 20px; z-index: 100; font-weight: bold; letter-spacing: 2px; opacity: 0.7; }

        /* Navigation */
        .nav { 
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); 
            background: rgba(0,0,0,0.8); padding: 10px 30px; border-radius: 50px; 
            display: flex; gap: 40px; border: 1px solid var(--glass); z-index: 100; backdrop-filter: blur(20px);
        }
        .nav-icon { font-size: 1.8rem; cursor: pointer; transition: 0.3s; opacity: 0.5; }
        .nav-icon.active { opacity: 1; transform: scale(1.2); }

        @keyframes float { 0%, 100% { transform: translateY(0) scale(1); } 50% { transform: translateY(-20px) scale(1.05); } }
    </style>
</head>
<body>

<video id="ar-viewport" autoplay playsinline></video>
<div id="ar-overlay"></div>
<div class="creator-tag">M.D.</div>

<header>
    <div class="logo">TADY</div>
    <div class="slogan">tady se dƒõje v≈°echno</div>
</header>

<div class="container" id="main-ui">
    <div id="map"></div>
    
    <div style="background: var(--glass); padding: 25px; border-radius: 30px; backdrop-filter: blur(10px);">
        <textarea id="msg" placeholder="Zanechte stopu pro svƒõt..." style="width:100%; background:transparent; border:none; color:white; font-size:1.1rem; outline:none; resize:none;" rows="2"></textarea>
        <div style="display:flex; gap:10px; margin-top:15px;">
            <button onclick="save('normal')" style="flex:1; padding:15px; border-radius:15px; border:1px solid var(--cyan); background:transparent; color:var(--cyan); font-weight:bold;">SOCI√ÅLN√ç</button>
            <button onclick="save('gold')" style="flex:1; padding:15px; border-radius:15px; border:none; background:var(--gold); color:black; font-weight:bold;">BYZNYS (29 Kƒç)</button>
        </div>
    </div>
</div>

<div class="nav">
    <div class="nav-icon active" onclick="setMode('map', this)">üó∫Ô∏è</div>
    <div class="nav-icon" onclick="setMode('ar', this)">‚ú®</div>
    <div class="nav-icon" onclick="callAI()">üß†</div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const API_KEY = "AIzaSyDOLpRJ9EOJvjPEWayPnWztnVdj8btUDA4";
    let map;

    function init() {
        map = L.map('map', {zoomControl: false}).setView([50.91, 14.62], 16);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png').addTo(map);
        loadPoints();
    }

    async function setMode(mode, el) {
        document.querySelectorAll('.nav-icon').forEach(i => i.classList.remove('active'));
        el.classList.add('active');

        const video = document.getElementById('ar-viewport');
        const ui = document.getElementById('main-ui');
        const overlay = document.getElementById('ar-overlay');

        if(mode === 'ar') {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
            video.srcObject = stream;
            video.style.display = 'block';
            ui.style.opacity = '0';
            setTimeout(() => ui.style.display = 'none', 500);
            renderAR();
        } else {
            video.style.display = 'none';
            ui.style.display = 'block';
            setTimeout(() => ui.style.opacity = '1', 10);
            overlay.innerHTML = '';
        }
    }

    function save(type) {
        const text = document.getElementById('msg').value;
        if(!text) return;
        navigator.geolocation.getCurrentPosition(p => {
            let data = JSON.parse(localStorage.getItem('tady_global')) || [];
            data.push({ text, type, lat: p.coords.latitude, lng: p.coords.longitude });
            localStorage.setItem('tady_global', JSON.stringify(data));
            location.reload();
        });
    }

    function loadPoints() {
        const data = JSON.parse(localStorage.getItem('tady_global')) || [];
        data.forEach(p => {
            L.circle([p.lat, p.lng], {radius: 40, color: p.type==='gold'?'#ffd700':'#00f2ff'}).addTo(map);
        });
    }

    function renderAR() {
        const overlay = document.getElementById('ar-overlay');
        const data = JSON.parse(localStorage.getItem('tady_global')) || [];
        data.slice(-6).forEach((p, i) => {
            const b = document.createElement('div');
            b.className = `bubble ${p.type === 'gold' ? 'gold' : ''}`;
            b.style.left = (15 + (i * 10)) + '%';
            b.style.top = (20 + (i * 12)) + '%';
            b.innerHTML = p.text;
            overlay.appendChild(b);
        });
    }

    async function callAI() {
        alert("Glob√°ln√≠ mozek TADY se probouz√≠...");
    }

    window.onload = init;
</script>
</body>
</html>
