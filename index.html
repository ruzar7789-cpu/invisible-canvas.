
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>TADY - Umísti svůj vzkaz</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Inter', sans-serif; }
        .ui-panel {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 85%; max-width: 380px; z-index: 100;
            background: rgba(10, 14, 20, 0.85); backdrop-filter: blur(15px);
            padding: 25px; border-radius: 24px; border: 1px solid #00f2ff; color: white; text-align: center;
        }
        input, textarea { 
            width: 100%; background: rgba(255,255,255,0.1); border: 1px solid rgba(0,242,255,0.3); 
            border-radius: 12px; padding: 12px; color: white; margin: 8px 0; box-sizing: border-box;
        }
        .btn-main { 
            background: linear-gradient(45deg, #00f2ff, #0072ff); color: black; border: none; 
            padding: 15px; width: 100%; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px;
        }
        #crosshair {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 30px; height: 30px; border: 2px solid #00f2ff; border-radius: 50%;
            z-index: 50; pointer-events: none;
        }
        #crosshair::after { content: ''; position: absolute; top: 50%; left: 50%; width: 4px; height: 4px; background: #00f2ff; border-radius: 50%; transform: translate(-50%, -50%); }
    </style>
</head>
<body>

    <div id="crosshair"></div>

    <div class="ui-panel" id="ui">
        <div id="setup">
            <h2 style="margin:0 0 15px 0; color:#00f2ff; font-size:22px;">TADY</h2>
            <input type="text" id="jmeno" placeholder="Jméno / Firma">
            <textarea id="vzkaz" placeholder="Co zde chcete zanechat?"></textarea>
            <p style="font-size:12px; opacity:0.8;">Namiřte středem tam, kam chcete vzkaz umístit.</p>
            <button class="btn-main" onclick="confirmPayment()">UMÍSTIT PŘESNĚ SEM (500 Kč)</button>
        </div>

        <div id="payment" style="display:none;">
            <p>Aktivace místa platbou:</p>
            <div style="background:#000; padding:15px; border-radius:12px; font-family:monospace; border:1px solid #00f2ff; margin-bottom:15px;">
                IBAN: LT533250082844018353<br>
                Zpráva: TADY <span id="target-name"></span>
            </div>
            <button class="btn-main" onclick="deployAR()">ZAPLACENO - UKOTVIT VZKAZ</button>
        </div>
    </div>

    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;" vr-mode-ui="enabled: false">
        <a-entity camera look-controls>
            <a-entity cursor="fuse: false; rayOrigin: mouse;"></a-entity>
        </a-entity>

        <a-entity id="world"></a-entity>
    </a-scene>

    <script>
        function confirmPayment() {
            const name = document.getElementById('jmeno').value;
            if(!name) return alert("Zadejte jméno.");
            document.getElementById('target-name').innerText = name;
            document.getElementById('setup').style.display = 'none';
            document.getElementById('payment').style.display = 'block';
        }

        function deployAR() {
            const name = document.getElementById('jmeno').value;
            const text = document.getElementById('vzkaz').value;
            const world = document.getElementById('world');

            // Vytvoření nového AR panelu
            const newEntry = document.createElement('a-entity');
            
            // Pozice se určí podle toho, kam se uživatel právě dívá (cca 3 metry před něj)
            newEntry.setAttribute('position', '0 0 -3'); 
            
            // Aby se vzkaz nepohyboval s kamerou, musíme ho vyjmout z lokálního prostoru kamery 
            // a dát ho do globálního světa. V AR.js se to simuluje ukotvením k souřadnicím.
            newEntry.innerHTML = `
                <a-plane position="0 0 0" width="3" height="1.5" color="#0a0e14" opacity="0.9" material="transparent:true">
                    <a-text value="${name}\n${text}" align="center" color="#00f2ff" width="2.8"></a-text>
                </a-plane>
                <a-ring color="#00f2ff" radius-inner="1.6" radius-outer="1.65" rotation="-90 0 0" position="0 -1 0"></a-ring>
            `;

            world.appendChild(newEntry);
            document.getElementById('ui').style.display = 'none';
            document.getElementById('crosshair').style.display = 'none';
            alert("Vzkaz byl úspěšně ukotven na tomto místě!");
        }
    </script>
</body>
</html>

