<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>TADY - Oficiální Aplikace</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        :root { --neon: #00f2ff; --glass: rgba(10, 14, 20, 0.9); }
        body { margin: 0; background: #000; color: white; font-family: sans-serif; }
        
        /* ÚVODNÍ OBRAZOVKA */
        #home-screen {
            position: fixed; inset: 0; z-index: 5000;
            background: radial-gradient(circle at center, #001a1d 0%, #000 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .logo-main { font-size: 60px; font-weight: 900; color: var(--neon); letter-spacing: 5px; margin-bottom: 5px; }
        .slogan { font-size: 14px; opacity: 0.7; letter-spacing: 2px; margin-bottom: 40px; }

        /* NAVIGACE */
        .bottom-nav {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            z-index: 4000; display: flex; background: var(--glass);
            padding: 10px; border-radius: 40px; border: 1px solid var(--neon); gap: 15px;
        }
        .nav-item { background: none; border: none; color: white; padding: 10px 20px; border-radius: 30px; cursor: pointer; }
        .nav-item.active { background: var(--neon); color: #000; font-weight: bold; }

        /* AR A MAPA */
        #map-view { position: fixed; inset: 0; z-index: 500; display: none; }
        #ar-view { position: fixed; inset: 0; z-index: 100; display: none; }
        
        /* FORMULÁŘ */
        .modal {
            position: fixed; inset: 0; z-index: 6000; background: rgba(0,0,0,0.9);
            display: none; align-items: center; justify-content: center; padding: 20px;
        }
        .glass-box {
            background: var(--glass); border: 1px solid var(--neon);
            padding: 30px; border-radius: 30px; width: 100%; max-width: 350px; text-align: center;
        }
        .btn-action { background: var(--neon); color: #000; border: none; padding: 15px; width: 100%; border-radius: 12px; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="home-screen">
        <div class="logo-main">TADY</div>
        <div class="slogan">tady se děje všechno</div>
        <button class="btn-action" style="width: 200px;" onclick="goToApp()">VSTOUPIT</button>
    </div>

    <div id="map-view"></div>

    <div id="ar-view">
        <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;" vr-mode-ui="enabled: false">
            <a-entity camera id="main-cam">
                <a-entity id="ar-preview" position="0 0 -2" visible="false">
                    <a-plane width="1.5" height="0.8" color="#000" opacity="0.8">
                        <a-text id="ar-text-val" value="" align="center" color="#00f2ff" width="2" wrap-count="20"></a-text>
                    </a-plane>
                </a-entity>
            </a-entity>
            <a-entity id="persistent-world"></a-entity>
        </a-scene>
    </div>

    <div class="modal" id="create-modal">
        <div class="glass-box">
            <h2 style="color:var(--neon); margin-top:0;">NOVÝ VZKAZ</h2>
            <input type="text" id="jmeno" placeholder="Jméno / Firma">
            <textarea id="vzkaz" rows="4" placeholder="Váš vzkaz pro tento svět..."></textarea>
            <button class="btn-action" onclick="startPlacement()">UMÍSTIT V AR</button>
            <button style="background:none; border:none; color:white; margin-top:15px;" onclick="closeModal()">Zavřít</button>
        </div>
    </div>

    <div class="bottom-nav" id="main-nav" style="display:none;">
        <button class="nav-item active" id="nav-map" onclick="switchTab('map')">MAPA</button>
        <button class="nav-item" id="nav-ar" onclick="switchTab('ar')">AR SVĚT</button>
        <button class="nav-item" onclick="openModal()">+ TADY</button>
        <button class="nav-item" onclick="goHome()">DOMŮ</button>
    </div>

    <script>
        let map = L.map('map-view').setView([50.075, 14.437], 13);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

        function goToApp() {
            document.getElementById('home-screen').style.display = 'none';
            document.getElementById('main-nav').style.display = 'flex';
            switchTab('map');
        }

        function goHome() {
            document.getElementById('home-screen').style.display = 'flex';
            document.getElementById('main-nav').style.display = 'none';
            document.getElementById('map-view').style.display = 'none';
            document.getElementById('ar-view').style.display = 'none';
        }

        function switchTab(type) {
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.getElementById('map-view').style.display = 'none';
            document.getElementById('ar-view').style.display = 'none';

            if(type === 'map') {
                document.getElementById('map-view').style.display = 'block';
                document.getElementById('nav-map').classList.add('active');
            } else {
                document.getElementById('ar-view').style.display = 'block';
                document.getElementById('nav-ar').classList.add('active');
            }
        }

        function openModal() { document.getElementById('create-modal').style.display = 'flex'; }
        function closeModal() { document.getElementById('create-modal').style.display = 'none'; }

        function startPlacement() {
            const name = document.getElementById('jmeno').value;
            const text = document.getElementById('vzkaz').value;
            if(!name) return alert("Zadejte jméno.");

            closeModal();
            switchTab('ar');
            document.getElementById('ar-text-val').setAttribute('value', `${name}\n${text}`);
            document.getElementById('ar-preview').setAttribute('visible', 'true');
            
            alert("Namiřte mobil a po zaplacení se vzkaz uloží na mapu pro všechny s aplikací!");
        }
    </script>
</body>
</html>


