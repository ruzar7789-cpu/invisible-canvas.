<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>TADY - Tvo콏 sv콢j sv캩t</title>
    
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <style>
        :root { --neon: #00f2ff; --tmavy: #0a0a0a; --zlata: #ffd700; --bublina: rgba(0,242,255,0.2); }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--tmavy); color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        
        /* 1. 칔vodn칤 obrazovka */
        #splash { position: fixed; inset: 0; z-index: 1000; background: radial-gradient(circle, #002d30 0%, #000 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .logo { font-size: 60px; font-weight: 900; color: var(--neon); text-shadow: 0 0 20px var(--neon); margin: 0; }
        .slogan { font-size: 18px; color: #ccc; margin-top: 10px; }
        .btn-vstup { background: var(--neon); color: black; border-radius: 50px; padding: 15px 45px; font-weight: bold; cursor: pointer; margin-top: 30px; border: none; text-transform: uppercase; transition: transform 0.2s; }
        .btn-vstup:active { transform: scale(0.95); }

        /* 2. Kontejnery pro AR a Mapu */
        #AR-view, #mapa-view { display: none; width: 100%; height: 100vh; position: absolute; top: 0; left: 0; }
        #map-container { width: 100%; height: 100%; }

        /* 3. Spodn칤 Menu */
        .hlavni-menu { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); display: flex; gap: 40px; background: rgba(0,0,0,0.9); padding: 15px 35px; border-radius: 50px; border: 1px solid var(--neon); z-index: 100; align-items: center; box-shadow: 0 0 15px rgba(0,242,255,0.3); }
        .menu-ikona { color: var(--neon); font-size: 24px; cursor: pointer; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; }
        .menu-ikona:hover, .menu-ikona:active { opacity: 1; transform: scale(1.1); text-shadow: 0 0 8px var(--neon); }

        /* 4. Tla캜칤tko PLUS */
        .btn-pridat { position: fixed; bottom: 120px; right: 25px; width: 65px; height: 65px; background: var(--neon); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: black; font-size: 35px; font-weight: bold; z-index: 100; box-shadow: 0 0 20px var(--neon); border: none; cursor: pointer; transition: transform 0.2s; }
        .btn-pridat:active { transform: scale(0.9); }

        /* 5. Platebn칤 br치na / Editor stopy */
        #editor-stop { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 2000; padding: 20px; flex-direction: column; align-items: center; justify-content: center; }
        .karta { background: #1a1a1a; border: 2px solid var(--neon); padding: 25px; border-radius: 20px; width: 85%; max-width: 400px; text-align: center; box-shadow: 0 0 25px rgba(0,242,255,0.4); }
        textarea { width: 100%; height: 100px; background: #000; border: 1px solid var(--neon); color: white; padding: 10px; margin: 15px 0; border-radius: 10px; box-sizing: border-box; font-size: 16px; resize: none; }
        .btn-akce { background: var(--zlata); color: black; padding: 15px; border-radius: 10px; border: none; font-weight: bold; width: 100%; cursor: pointer; margin-top: 10px; font-size: 16px; transition: background 0.2s, transform 0.2s; }
        .btn-akce:hover { background: #e0c200; }
        .btn-akce:active { transform: scale(0.98); }

        /* Styl pro AR objekty (Digit치ln칤 sv캩tlu코ky) */
        .ar-objekt {
            position: absolute;
            background: var(--bublina);
            border: 1px solid var(--neon);
            border-radius: 15px;
            padding: 10px 15px;
            font-size: 16px;
            text-align: center;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 10px var(--neon);
            animation: pulse 2s infinite alternate; /* Pulzuj칤c칤 efekt */
            opacity: 0.9;
            color: white; /* Barva textu ve vzkazu */
        }

        @keyframes pulse {
            from { transform: scale(1); box-shadow: 0 0 10px var(--neon); }
            to { transform: scale(1.03); box-shadow: 0 0 20px var(--neon); }
        }
    </style>
</head>
<body>

    <div id="splash">
        <h1 class="logo">TADY</h1>
        <p class="slogan">Tvo콏 sv콢j digit치ln칤 sv캩t!</p>
        <button class="btn-vstup" onclick="startApp()">VSTOUPIT</button>
    </div>

    <div id="AR-view">
        <button class="btn-pridat" onclick="otevritEditor()">+</button>
        <div class="hlavni-menu">
            <span onclick="prepniNaMapu()" class="menu-ikona">游댌</span>
            <span onclick="prepniNaAR()" class="menu-ikona">游눫</span>
            <span onclick="alert('Profil a nastaven칤 TADY')" class="menu-ikona">游녻</span>
        </div>
        <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false; debug: false;">
            <a-camera gps-camera rotation-reader></a-camera>
            
            <a-text value="Restaurace U TADY: Dnes Sv칤캜kov치! 250 Kc" 
                     look-at="[gps-camera]" 
                     gps-entity-place="latitude: 50.9100; longitude: 14.6200;" 
                     scale="20 20 20" 
                     color="#ffd700" 
                     position="0 1 -10"></a-text>

            </a-scene>
    </div>

    <div id="mapa-view">
        <div id="map-container"></div>
        <div class="hlavni-menu">
            <span onclick="prepniNaMapu()" class="menu-ikona">游댌</span>
            <span onclick="prepniNaAR()" class="menu-ikona">游눫</span>
            <span onclick="alert('Profil a nastaven칤 TADY')" class="menu-ikona">游녻</span>
        </div>
    </div>

    <div id="editor-stop">
        <div class="karta">
            <h2 style="color:var(--neon)">UM칈STIT DIGIT츼LN칈 STOPU</h2>
            <p style="font-size: 14px;">Napi코 vzkaz, reklamu, menu nebo h치danku. Z콢stane TADY 24 hodin!</p>
            <textarea id="obsah" placeholder="Dnes sleva 10% na v코e! / Ahoj, z칤tra tu budu ve 3..."></textarea>
            
            <div style="background: white; padding: 10px; margin: 15px auto; width: 160px; border-radius: 12px;">
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=160x160&data=SPD*1.0*ACC:LT533250082844018353*BIC:REVOLT21*AM:29.00*CC:CZK*MSG:TADY_STOPA" 
                     alt="Platebn칤 QR" style="width:100%">
            </div>
            
            <div style="color:var(--zlata); font-size: 22px; font-weight:bold;">29 K캜 / 24 hodin</div>
            <p style="font-size: 12px; color: #aaa; margin: 5px 0;">
                Naskenuj QR k칩d ve sv칠 bankovn칤 aplikaci.<br>
                <strong>IBAN:</strong> LT53...8353
            </p>
            
            <button class="btn-akce" onclick="overitPlatbu()">M츼M ZAPLACENO A UM칈STIT</button>
            <button onclick="zavritEditor()" style="background:none; border:none; color:white; margin-top:15px; cursor:pointer;">Zru코it</button>
        </div>
    </div>

    <script>
        let mapa;
        let uzivatelLat = 50.91; // V칳choz칤 GPS pro test, bude aktualizov치no
        let uzivatelLon = 14.62; // V칳choz칤 GPS pro test, bude aktualizov치no

        // Z칤sk치n칤 aktu치ln칤 GPS polohy u쬴vatele
        if (navigator.geolocation) {
            navigator.geolocation.watchPosition(function(position) {
                uzivatelLat = position.coords.latitude;
                uzivatelLon = position.coords.longitude;
                // console.log("Aktu치ln칤 GPS: ", uzivatelLat, uzivatelLon);
            }, function(error) {
                console.warn('Geolocation error:', error);
                alert('Povolte pros칤m p콏칤stup k poloze pro plnou funkci TADY.');
            }, {
                enableHighAccuracy: true,
                maximumAge: 0,
                timeout: 27000
            });
        }

        function startApp() {
            document.getElementById('splash').style.display = 'none';
            document.getElementById('AR-view').style.display = 'block';
        }

        function prepniNaAR() {
            document.getElementById('mapa-view').style.display = 'none';
            document.getElementById('AR-view').style.display = 'block';
        }

        function prepniNaMapu() {
            document.getElementById('AR-view').style.display = 'none';
            document.getElementById('mapa-view').style.display = 'block';
            if (!mapa) {
                mapa = L.map('map-container').setView([uzivatelLat, uzivatelLon], 15);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mapa);
                // Uk치zka bodu na map캩 s re치lnou pozic칤
                L.marker([uzivatelLat, uzivatelLon]).addTo(mapa).bindPopup('Tvoje pozice TADY!');
                // Zde se budou na캜칤tat body z Neon DB
            } else {
                mapa.setView([uzivatelLat, uzivatelLon], mapa.getZoom()); // Aktualizuj pozici mapy
            }
        }

        function otevritEditor() { document.getElementById('editor-stop').style.display = 'flex'; }
        function zavritEditor() { document.getElementById('editor-stop').style.display = 'none'; }

        function overitPlatbu() {
            const text = document.getElementById('obsah').value;
            if(!text) return alert("Nejd콏칤ve napi코 obsah sv칠 digit치ln칤 stopy!");
            
            alert("Platba 29 K캜 potvrzena! Tvoje digit치ln칤 stopa se nyn칤 um칤s콘uje v AR prostoru.");
            
            // TADY se te캞 budou odes칤lat data do tv칠ho Neon DB (Red-Thunder)
            // Bude코 pot콏ebovat API endpoint pro Neon, aby se ulo쬴l text, GPS a 캜as.
            // console.log("Ukl치d치m do Neonu:", {
            //     text: text,
            //     latitude: uzivatelLat,
            //     longitude: uzivatelLon,
            //     timestamp: new Date().toISOString(),
            //     cena: "29 Kc",
            //     platnost: "24 hodin"
            // });

            // Dynamick칠 vytvo콏en칤 AR objektu po platb캩
            // Toto je jen demo, re치ln캩 by to m캩lo p콏ij칤t z datab치ze
            const newEntity = document.createElement('a-text');
            newEntity.setAttribute('value', text);
            newEntity.setAttribute('look-at', '[gps-camera]');
            newEntity.setAttribute('gps-entity-place', `latitude: ${uzivatelLat}; longitude: ${uzivatelLon};`);
            newEntity.setAttribute('scale', '15 15 15');
            newEntity.setAttribute('color', '#00f2ff'); // Neon barva pro vzkazy
            newEntity.setAttribute('position', '0 0 -10'); // Lehk칳 posun, aby nebyl na nule

            document.querySelector('a-scene').appendChild(newEntity);

            zavritEditor();
        }
    </script>
</body>
</html>

